# ƒêHTN - API Contracts

## Authentication API

### Login (Username/Password)

```
POST /users/login
Content-Type: multipart/form-data

Body:
  username: string
  password: string

Response:
  {
    data: {
      userInfo: UserInfo,
      tokenInfo: {
        accessToken: string,
        refreshToken: string,
        expiresIn: number
      },
      moduleList: ModuleNode[]
    }
  }
```

### Login (USB Token)

```
POST /users/login/tk
Content-Type: multipart/form-data

Body:
  serialToken: string

Response: Same as username/password login
```

### Logout

```
POST /users/logout
Authorization: Bearer <token>
```

### Refresh Token

```
POST /users/refresh-token
Body:
  oldToken: string
  rememberPassword: boolean

Response:
  {
    tokenInfo: TokenInfo,
    userInfo: UserInfo,
    moduleList: ModuleNode[]
  }
```

### Switch Role

```
GET /users/switchRole/{roleId}
Authorization: Bearer <token>

Response:
  authorize: ModuleNode[]
```

---

## Document API

### Get All Documents Out

```
GET /documents/all-out
Authorization: Bearer <token>
```

### Get Document by ID

```
GET /documents/{documentId}
Authorization: Bearer <token>
Query:
  notId?: string
  tab?: string
```

### Save Document

```
POST /documents/save
Authorization: Bearer <token>
Body: FormData with document data
```

### Reject Document

```
POST /documents/reject
Authorization: Bearer <token>
Body:
  documentId: number
  comment: string
  attachments?: File[]
```

### Retake Document

```
POST /documents/retake
Authorization: Bearer <token>
Body:
  pid: string
  documentId: number
  rejectComment: string
  files?: File[]
```

---

## Task API

### Get Tasks

```
GET /tasks
Authorization: Bearer <token>
Query:
  page?: number
  status?: string
```

### Complete Task

```
POST /tasks/{taskId}/complete
Authorization: Bearer <token>
Body:
  comment: string
  files?: File[]
```

---

## File API

### Upload File

```
POST /files/upload
Authorization: Bearer <token>
Content-Type: multipart/form-data
Query:
  encrypt?: boolean
```

### Download File

```
GET /files/{fileId}/download
Authorization: Bearer <token>
```

---

## Query Parameters

| Parameter      | Description                                                     |
| -------------- | --------------------------------------------------------------- |
| `encrypt=true` | Enable server-side encryption (auto-added when encrypt mode on) |
| `page`         | Pagination page number                                          |
| `size`         | Page size                                                       |
| `sort`         | Sort field                                                      |
| `order`        | Sort order (asc/desc)                                           |

---

## Security Headers

| Header          | Value                                       |
| --------------- | ------------------------------------------- |
| `Authorization` | `Bearer <accessToken>`                      |
| `Content-Type`  | `application/json` or `multipart/form-data` |

---

_Generated by BMad Document Project Workflow | 2026-01-14_
